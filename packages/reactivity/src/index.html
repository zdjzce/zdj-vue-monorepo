<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    let activeEffect
    const WeakEffect = new WeakMap()
    function reactive (obj) {
      return new Proxy(obj, {
        get (target, key, receiver) {
          if (!activeEffect) return
          const weakMap = WeakEffect.get(target)
          return Reflect.get(target, key, receiver)
        },
        set (target, key, newVal, receiver) {
          target[key] = newVal
          trigger(target, key, newVal, receiver)
          return true
        }
      })
    }

    function trigger (target, key, newVal, receiver) {
      debugger
      // console.log('is ------ trigger', target, newVal)
      activeEffect && activeEffect()
    }

    function effect (fn) {
      activeEffect = fn
      return fn()
    }
    const obj = {
      foo: 1
    }
    const data = reactive(obj)
    let value
    effect(() => {
      value = data.foo
    })
    data.foo = 2
  </script>
</body>

</html>